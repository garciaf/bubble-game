var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);import{r as i}from"./phaser-y5S3hZEA.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var s=i();class n{constructor(t){e(this,"context"),e(this,"states",new Map),e(this,"currentState"),e(this,"isSwithingState",!1),e(this,"stateQueue",[]),this.context=t}addState(t,e){var i,s,n;return this.states.set(t,{name:t,onEnter:null==(i=null==e?void 0:e.onEnter)?void 0:i.bind(this.context),onUpdate:null==(s=null==e?void 0:e.onUpdate)?void 0:s.bind(this.context),onExit:null==(n=null==e?void 0:e.onExit)?void 0:n.bind(this.context)}),this}isCurrentState(t){var e;return(null==(e=this.currentState)?void 0:e.name)===t}setState(t){var e,i;if(!this.states.has(t))throw new Error(`State ${t} does not exist`);this.isSwithingState?this.stateQueue.push(t):((null==(e=this.currentState)?void 0:e.onExit)&&this.currentState.onExit(),this.currentState=this.states.get(t),(null==(i=this.currentState)?void 0:i.onEnter)&&this.currentState.onEnter())}update(t){var e;if(this.stateQueue.length>0){const t=this.stateQueue.shift();this.setState(t)}(null==(e=this.currentState)?void 0:e.onUpdate)&&this.currentState.onUpdate(t)}}const o=new s.Events.EventEmitter;class r{constructor(t,i,s){e(this,"stateMachine"),e(this,"bubble"),e(this,"input"),e(this,"pointer"),e(this,"growthRate",.05),e(this,"pointDeceaseRate",.4),e(this,"point",1e3),this.bubble=t,this.pointer=i,this.input=s,this.stateMachine=new n(this),this.stateMachine.addState("idle",{onEnter:this.idleOnEnter}).addState("growing",{onUpdate:this.growingOnUpdate}).addState("popped",{onEnter:this.poppedOnEnter}),this.bubble.setInteractive({useHandCursor:!0}),this.input.on("pointerdown",(t=>{this.stateMachine.isCurrentState("growing")&&this.bubble.getBounds().contains(t.x,t.y)&&this.stateMachine.setState("popped")})),this.stateMachine.setState("idle")}update(t){this.stateMachine.update(t)}idleOnEnter(){this.stateMachine.setState("growing")}growingOnUpdate(t){if(!this.pointer.isDown||!this.bubble.getBounds().contains(this.pointer.x,this.pointer.y)){{const e=this.bubble.radius+this.growthRate*t;this.bubble.setRadius(e),this.point=this.point-this.pointDeceaseRate*t}return this.point<=0?(this.point=0,void this.stateMachine.setState("popped")):void 0}this.stateMachine.setState("popped")}poppedOnEnter(){o.emit("bubble.popped",this.point),this.bubble.setVisible(!1),this.bubble.setActive(!1),this.bubble.destroy()}}class a extends s.Scene{constructor(){super("Game"),e(this,"bubbles"),e(this,"pointer"),e(this,"bubbleSpawnRate",500),e(this,"colors",[16711680,65280,255,16776960,16711935,65535,16746496,65416,8913151,8947712,8913032,34952,8947848,0])}init(){this.bubbles=[],this.pointer=this.input.activePointer}preload(){this.load.setPath("assets")}create(){this.cameras.main.setBackgroundColor(166648),this.time.addEvent({delay:this.bubbleSpawnRate,callback:()=>{const t=s.Math.Between(50,this.scale.width-50),e=s.Math.Between(50,this.scale.height-50),i=this.colors[s.Math.Between(0,this.colors.length-1)],n=this.drawCircle(t,e,10,i);this.bubbles.push(new r(n,this.pointer,this.input))},loop:!0}),this.scene.launch("ui")}drawCircle(t,e,i,s){return this.add.circle(t,e,i,s,1)}update(t,e){this.bubbles.forEach((t=>{t.update(e)}))}}class h extends s.Scene{constructor(){super({key:"ui"}),e(this,"coinLabel"),e(this,"score",0)}init(){this.score=0}create(){this.coinLabel=this.add.text(36,36,"Score : 0",{fontSize:32}),o.on("bubble.popped",(t=>{this.score+=t,this.coinLabel.setText("Score : "+Math.floor(this.score))}))}}const c={type:s.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#028af8",scale:{mode:s.Scale.FIT,autoCenter:s.Scale.CENTER_BOTH},scene:[a,h]};document.addEventListener("DOMContentLoaded",(()=>{new s.Game({...c,parent:"game-container"})}));
